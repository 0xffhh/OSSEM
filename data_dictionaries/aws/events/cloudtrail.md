# CloudTrail Event Schema

## Description
AWS CloudTrail Log format common schema.

## Data Dictionary
|Standard Name|Field Name|Type|Description|Sample Value|
|---|---|---|---|---|
|TBD|eventTime|The date and time request was made, in coordinated universal time(UTC).|datetime|`2020-03-17T06:07:08Z`|
|TBD|eventVersion|The version of the log format.|string|`1.05`|
|TBD|userIdentity|information about the user that made a request. See [CloudTrail User Identity Element](https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-event-reference-user-identity.html)|dictionary|`{"type": "Root","principalId":"123456789012","arn": "arn:aws:iam::123456789012:root","accountId": "123456789012","accessKeyId": "ASIA3WIKNJYLTIU3WTFN","sessionContext": {"sessionIssuer": {},       "webIdFederationData": {},"attributes": {"mfaAuthenticated": "false","creationDate": "2020-03-17T04:51:58Z"}}`|
|TBD|eventSource|The service that the request was made to. name is typically short form of the service name without spaces.|string|`ec2.amazonaws.com`|
|TBD|eventName|The requested action, which is one of the actions in the API for that service.|string|`CreateFlowLogs`|
|TBD|awsRegion|The AWS region that the request was made to. See [CloudTrail Supported Regions](https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-supported-regions.html)|string|`us-east-2`|
|TBD|sourceIPAddress|The IP address that the request was made from.For AWS services, DNS name is displayed.|string|`123.123.123.123`|
|TBD|userAgent|The agent through which the request was made, such as AWS management console,AWS service, AWS SDK or AWS CLI.|string|`signin.amazonaws.com`|
|TBD|errorCode|The AWS service error id the request returns an error|string|`TrailNotFoundException`|
|TBD|errorMessage|if the request returns an error, the description of the error.This message includes the message for authorization failures.|string|`Unknown trail: myTrail2 for the user: 123456789012`|
|TBD|requestParameters|The parameters,if any,that were sent with the request.These parameters are documented in the API reference documentation for respective AWS service.|dictionary|`{"CreateFlowLogsRequest": {"ResourceId": {"tag": 1, "content": "vpc-12345678"}, "MaxAggregationInterval": 600, "ResourceType": "VPC", "LogDestination":"arn:aws:s3:::vpc-logs-for-hunting", "LogDestinationType": "s3", "TrafficType": "ACCEPT"}}`|
|TBD|responseElements|The response element for actions that make changes(create,update,or delete actions).If action does not change(e.g.get or list) this element is ommitted.|dictionary|`{"CreateFlowLogsResponse": {"xmlns": "http://ec2.amazonaws.com/doc/2016-11-15/","requestId": "2ee6fecc-8287-4a68-ba2d-21b666d6cbb0","clientToken": "ABCDexKLX8mMDT/7aganQUywyjkJG8bu3enkYDTW+vY=","unsuccessful": "","flowLogIdSet": {"item": "fl-01c931a7296ed28c9"}}}`|
|TBD|additionalEventData|Additional data about the event that was not part of the request or response.|string|`TBD`
|TBD|requestID|The value that identifies the request.The service being called generates this value.|string|`2ee6fecc-8287-4a68-ba2d-21b666d6cbb0`|
|TBD|eventID|GUID generatedby CloudTrail to uniquely identify each event.|string|`39cdc1e3-f9bf-4084-ba12-ca71b47ee6ee`|
|TBD|eventType|Identifies the type of event that generated the event record.|string|`AwsApiCall`|
|TBD|apiVersion|Identifies the API version associated with the AwsApiCall eventType value.|string|`TBD`|
|TBD|managementEvent|A Boolean value that identifies whether the event is a management event. It is shown if eventversion is 1.06 or higher.and eventtype if one of the following:AwsApiCall, AwsConsoleAction, AwsConsoleSignIn, AwsServiceEvent|bool|True|
|TBD|readOnly|Identifies whether this operation is a read-only operation.This can be one of following values. true(e.g.DescribeTrails), false(e.g.DeleteTrail)|bool|True|
|TBD|resources|A list of resources accessed in the event.The format-AWS::aws-serivce-name::data-type-name.|string|`arn:aws:iam::123456789012:role/myRole`|
|TBD|recipientAccountId|Represents the account ID that received this event.for cross account access, this may be different than userIdentity element AccountID.|string|`123456789012`|
|TBD|serviceEventDetails|Identifies the service event,including what triggered the evnet and the result. See [AWS Service Events](https://docs.aws.amazon.com/awscloudtrail/latest/userguide/non-api-aws-service-events.html)|dictionary|`{"keyId": "7944f0ec-EXAMPLE"}`|
|TBD|sharedEvnetID|GUID generated by CloudTrail to uniquely identify CloudTrail events from the same AWS action that is sent to different AWS accounts. See [SharedEventID Example](https://docs.aws.amazon.com/awscloudtrail/latest/userguide/shared-event-ID.html)|string|`2b5e7544-b7c7-46bf-993b-4a24b1d78904`|
|TBD|vpcEndpointId|Identifies the VPC endpoint in which requests were made from a VPC to another AWS service,such as Amazon s3.|string|TBD|

## Reference
- https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-event-reference.html
- https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-event-reference-record-contents.html
- https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-aws-service-specific-topics.html#cloudtrail-aws-service-specific-topics-organizations
