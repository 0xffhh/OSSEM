title: 'Event ID 4649: A replay attack was detected'
description: This event generates on domain controllers when KRB_AP_ERR_REPEAT 
  Kerberos response was sent to the client.

  Domain controllers cache information from recently received tickets. If the 
  server name, client name, time, and microsecond fields from the Authenticator 
  match recently seen entries in the cache, it will return KRB_AP_ERR_REPEAT. 
  You can read more about this in RFC-1510. One potential cause for this is a 
  misconfigured network device between the client and server that could send 
  the same packet(s) repeatedly.
platform: windows
log_source: security
event_code: '4649'
event_fields:
- standard_name: user_reporter_sid
  standard_type: TBD
  name: SubjectUserSid
  type: string
  description: SID of account that that reported information about the replay.
  sample_value: S-1-5-18
- standard_name: user_reporter_name
  standard_type: TBD
  name: SubjectUserName
  type: string
  description: the name of the account that reported information about the replay.
  sample_value: DC01$
- standard_name: user_reporter_domain
  standard_type: TBD
  name: SubjectDomainName
  type: string
  description: subject’s domain or computer name.
  sample_value: CONTOSO
- standard_name: user_reporter_id
  standard_type: TBD
  name: SubjectLogonId
  type: integer
  description: hexadecimal value that can help you correlate this event with 
    recent events that might contain the same Logon ID.
  sample_value: '0x3e7'
- standard_name: user_name
  standard_type: TBD
  name: TargetUserName
  type: string
  description: the name of the account whose credential were replayed.
  sample_value: DC02$
- standard_name: user_domain
  standard_type: TBD
  name: TargetDomainName
  type: string
  description: the domain of the account whose credential were replayed.
  sample_value: CONTOSO.LOCAL
- standard_name: logon_process_name
  standard_type: TBD
  name: LogonProcessName
  type: string
  description: The name of the trusted logon process that was used for the replay.
  sample_value: Kerberos
- standard_name: logon_authentication_package_name
  standard_type: TBD
  name: AuthenticationPackageName
  type: string
  description: The name of the authentication package which was used for the Kerberos.
  sample_value: Kerberos
- standard_name: src_host_name
  standard_type: TBD
  name: WorkstationName
  type: string
  description: machine name from which attempt was performed. May not exist.
  sample_value: '-'
- standard_name: logon_transmitted_services
  standard_type: TBD
  name: TransmittedServices
  type: string
  description: the list of transmitted services. Transmitted services are 
    populated if the logon was a result of a S4U (Service For User) logon 
    process. S4U is a Microsoft extension to the Kerberos Protocol to allow an 
    application service to obtain a Kerberos service ticket on behalf of a 
    user – most commonly done by a front-end website to access an internal 
    resource on behalf of a user.
  sample_value: '-'
- standard_name: ticket_request_type
  standard_type: TBD
  name: RequestType
  type: string
  description: The type of request.
  sample_value: 'KRB_AP_REQ'
- standard_name: process_id
  standard_type: TBD
  name: ProcessId
  type: string
  description: hexadecimal Process ID of the process.
  sample_value: '0xb9adc08'
- standard_name: process_path
  standard_type: TBD
  name: ProcessName
  type: string
  description: full path and the name of the executable for the process.
  sample_value: 'C:\Windows\System32\dns.exe'
references:
- text: MS Source
  link: https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4649.md
- text: MS Security Auditing Category - Logon/Logoff
  link: https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/advanced-security-audit-policy-settings#logonlogoff
- text: MS Security Auditing Sub-category - Audit Other Logon/Logoff Events
  link: https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/audit-other-logonlogoff-events.md
tags:
- Logon/Logoff
- Audit Logoff
